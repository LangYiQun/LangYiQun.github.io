<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"langyiqun.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="RubyRubyæ˜¯ä¸€ä¸ªè¯¦ç»†çš„å†…å­˜å­ç³»ç»Ÿçš„æ¨¡æ‹Ÿæ¨¡å‹ã€‚å¯ä»¥é€šè¿‡å„ç§æ›¿æ¢ç­–ç•¥ã€ä¸€è‡´æ€§åè®®å®ç°ã€äº’è¿ç½‘ç»œã€DMAå’Œå†…å­˜æ§åˆ¶å™¨ã€å‘èµ·å†…å­˜è¯·æ±‚å’Œå¤„ç†å“åº”çš„å„ç§å®šåºå™¨æ¥å»ºæ¨¡åŒ…å«ï¼ˆinclusiveï¼‰&#x2F;ç‹¬å ï¼ˆexclusiveï¼‰ç¼“å­˜å±‚æ¬¡ç»“æ„ã€‚è¿™äº›æ¨¡å‹æ˜¯æ¨¡å—åŒ–çš„ã€çµæ´»çš„å’Œé«˜åº¦å¯é…ç½®çš„ã€‚ Rubyæœ‰ä»¥ä¸‹ä¸‰ä¸ªç‰¹ç‚¹ï¼š  å…³æ³¨ç‚¹åˆ†ç¦»ã€‚å°†å†…å­˜ç³»ç»Ÿçš„å„ä¸ªæ¨¡å‹æ¨¡å—åŒ–ï¼Œä¾‹å¦‚ï¼Œä¸€è‡´æ€§åè®®è§„èŒƒä¸æ›¿æ¢ç­–ç•¥å’Œç¼“å­˜ç´¢å¼•æ˜ å°„æ˜¯åˆ†å¼€çš„">
<meta property="og:type" content="article">
<meta property="og:title" content="Gem5æ¨¡æ‹Ÿå™¨å­¦ä¹ ï¼ˆå…«ï¼‰â€”â€”â€”â€”é€šè¿‡Rubyå®ç°ç¼“å­˜ä¸€è‡´æ€§åè®®">
<meta property="og:url" content="https://langyiqun.github.io/2023/11/25/Gem5%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89/index.html">
<meta property="og:site_name" content="å¤è™«çš„åšå®¢">
<meta property="og:description" content="RubyRubyæ˜¯ä¸€ä¸ªè¯¦ç»†çš„å†…å­˜å­ç³»ç»Ÿçš„æ¨¡æ‹Ÿæ¨¡å‹ã€‚å¯ä»¥é€šè¿‡å„ç§æ›¿æ¢ç­–ç•¥ã€ä¸€è‡´æ€§åè®®å®ç°ã€äº’è¿ç½‘ç»œã€DMAå’Œå†…å­˜æ§åˆ¶å™¨ã€å‘èµ·å†…å­˜è¯·æ±‚å’Œå¤„ç†å“åº”çš„å„ç§å®šåºå™¨æ¥å»ºæ¨¡åŒ…å«ï¼ˆinclusiveï¼‰&#x2F;ç‹¬å ï¼ˆexclusiveï¼‰ç¼“å­˜å±‚æ¬¡ç»“æ„ã€‚è¿™äº›æ¨¡å‹æ˜¯æ¨¡å—åŒ–çš„ã€çµæ´»çš„å’Œé«˜åº¦å¯é…ç½®çš„ã€‚ Rubyæœ‰ä»¥ä¸‹ä¸‰ä¸ªç‰¹ç‚¹ï¼š  å…³æ³¨ç‚¹åˆ†ç¦»ã€‚å°†å†…å­˜ç³»ç»Ÿçš„å„ä¸ªæ¨¡å‹æ¨¡å—åŒ–ï¼Œä¾‹å¦‚ï¼Œä¸€è‡´æ€§åè®®è§„èŒƒä¸æ›¿æ¢ç­–ç•¥å’Œç¼“å­˜ç´¢å¼•æ˜ å°„æ˜¯åˆ†å¼€çš„">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://langyiqun.github.io/Gem5%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89/image-20231204190803198.png">
<meta property="og:image" content="https://langyiqun.github.io/Gem5%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89/v2-c033b43df7af58f9468432e564c4266f_720w.png">
<meta property="article:published_time" content="2023-11-25T07:19:53.000Z">
<meta property="article:modified_time" content="2023-12-09T07:13:23.369Z">
<meta property="article:author" content="Mr .L">
<meta property="article:tag" content="Ruby">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://langyiqun.github.io/Gem5%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89/image-20231204190803198.png">


<link rel="canonical" href="https://langyiqun.github.io/2023/11/25/Gem5%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://langyiqun.github.io/2023/11/25/Gem5%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89/","path":"2023/11/25/Gem5æ¨¡æ‹Ÿå™¨å­¦ä¹ ï¼ˆå…«ï¼‰/","title":"Gem5æ¨¡æ‹Ÿå™¨å­¦ä¹ ï¼ˆå…«ï¼‰â€”â€”â€”â€”é€šè¿‡Rubyå®ç°ç¼“å­˜ä¸€è‡´æ€§åè®®"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Gem5æ¨¡æ‹Ÿå™¨å­¦ä¹ ï¼ˆå…«ï¼‰â€”â€”â€”â€”é€šè¿‡Rubyå®ç°ç¼“å­˜ä¸€è‡´æ€§åè®® | å¤è™«çš„åšå®¢</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">å¤è™«çš„åšå®¢</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">å´é“å¤©å‡‰å¥½ä¸ªç§‹</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Ruby"><span class="nav-number">1.</span> <span class="nav-text">Ruby</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E4%B8%80%E8%87%B4%E6%80%A7%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%AD%A5%E9%AA%A4"><span class="nav-number">2.</span> <span class="nav-text">å®ç°ä¸€è‡´æ€§åè®®çš„æ­¥éª¤</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%B3%A8%E5%86%8C%E7%8A%B6%E6%80%81%E6%9C%BA"><span class="nav-number">2.1.</span> <span class="nav-text">1. æ³¨å†ŒçŠ¶æ€æœº</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E7%BC%96%E5%86%99%E7%8A%B6%E6%80%81%E6%9C%BA%E6%96%87%E4%BB%B6"><span class="nav-number">2.2.</span> <span class="nav-text">2.ç¼–å†™çŠ¶æ€æœºæ–‡ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E7%8A%B6%E6%80%81%E6%9C%BA%E5%A3%B0%E6%98%8E"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.1 çŠ¶æ€æœºå£°æ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E7%8A%B6%E6%80%81%E6%9C%BA%E5%8F%82%E6%95%B0%E5%A3%B0%E6%98%8E"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2 çŠ¶æ€æœºå‚æ•°å£°æ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E7%8A%B6%E6%80%81%E5%A3%B0%E6%98%8E"><span class="nav-number">2.2.3.</span> <span class="nav-text">2.3 çŠ¶æ€å£°æ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-%E4%BA%8B%E4%BB%B6%E5%A3%B0%E6%98%8E"><span class="nav-number">2.2.4.</span> <span class="nav-text">2.4 äº‹ä»¶å£°æ˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-number">2.2.5.</span> <span class="nav-text">2.5 ç”¨æˆ·å®šä¹‰ç»“æ„ä½“</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Entry"><span class="nav-number">2.2.5.1.</span> <span class="nav-text">Entry</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TBE"><span class="nav-number">2.2.5.2.</span> <span class="nav-text">TBE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TBETable"><span class="nav-number">2.2.5.3.</span> <span class="nav-text">TBETable</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%96%E9%83%A8%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E"><span class="nav-number">2.2.5.4.</span> <span class="nav-text">å¤–éƒ¨å‡½æ•°å£°æ˜</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B7%E6%9D%BF%E4%BB%A3%E7%A0%81"><span class="nav-number">2.2.5.5.</span> <span class="nav-text">æ ·æ¿ä»£ç </span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%AB%AF%E5%8F%A3"><span class="nav-number">2.2.6.</span> <span class="nav-text">2.6 è¾“å…¥è¾“å‡ºç«¯å£</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Mr .L</p>
  <div class="site-description" itemprop="description">this is a personal blog of Mr .L</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">46</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yourname" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;yourname" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yourname@gmail.com" title="E-Mail â†’ mailto:yourname@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/yourname" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;yourname" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/yourname" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;yourname" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/yourname" title="FB Page â†’ https:&#x2F;&#x2F;www.facebook.com&#x2F;yourname" rel="noopener me" target="_blank"><i class="fab fa-facebook fa-fw"></i>FB Page</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/yourname" title="StackOverflow â†’ https:&#x2F;&#x2F;stackoverflow.com&#x2F;yourname" rel="noopener me" target="_blank"><i class="fab fa-stack-overflow fa-fw"></i>StackOverflow</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://youtube.com/yourname" title="YouTube â†’ https:&#x2F;&#x2F;youtube.com&#x2F;yourname" rel="noopener me" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/yourname" title="Instagram â†’ https:&#x2F;&#x2F;instagram.com&#x2F;yourname" rel="noopener me" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
      <span class="links-of-author-item">
        <a href="skype:yourname?call|chat" title="Skype â†’ skype:yourname?call|chat" rel="noopener me" target="_blank"><i class="fab fa-skype fa-fw"></i>Skype</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://langyiqun.github.io/2023/11/25/Gem5%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mr .L">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å¤è™«çš„åšå®¢">
      <meta itemprop="description" content="this is a personal blog of Mr .L">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Gem5æ¨¡æ‹Ÿå™¨å­¦ä¹ ï¼ˆå…«ï¼‰â€”â€”â€”â€”é€šè¿‡Rubyå®ç°ç¼“å­˜ä¸€è‡´æ€§åè®® | å¤è™«çš„åšå®¢">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Gem5æ¨¡æ‹Ÿå™¨å­¦ä¹ ï¼ˆå…«ï¼‰â€”â€”â€”â€”é€šè¿‡Rubyå®ç°ç¼“å­˜ä¸€è‡´æ€§åè®®
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2023-11-25 15:19:53" itemprop="dateCreated datePublished" datetime="2023-11-25T15:19:53+08:00">2023-11-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-12-09 15:13:23" itemprop="dateModified" datetime="2023-12-09T15:13:23+08:00">2023-12-09</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h1><p>Rubyæ˜¯ä¸€ä¸ªè¯¦ç»†çš„å†…å­˜å­ç³»ç»Ÿçš„æ¨¡æ‹Ÿæ¨¡å‹ã€‚å¯ä»¥é€šè¿‡å„ç§æ›¿æ¢ç­–ç•¥ã€ä¸€è‡´æ€§åè®®å®ç°ã€äº’è¿ç½‘ç»œã€DMAå’Œå†…å­˜æ§åˆ¶å™¨ã€å‘èµ·å†…å­˜è¯·æ±‚å’Œå¤„ç†å“åº”çš„å„ç§å®šåºå™¨æ¥å»ºæ¨¡åŒ…å«ï¼ˆinclusiveï¼‰&#x2F;ç‹¬å ï¼ˆexclusiveï¼‰ç¼“å­˜å±‚æ¬¡ç»“æ„ã€‚è¿™äº›æ¨¡å‹æ˜¯æ¨¡å—åŒ–çš„ã€çµæ´»çš„å’Œé«˜åº¦å¯é…ç½®çš„ã€‚</p>
<p>Rubyæœ‰ä»¥ä¸‹ä¸‰ä¸ªç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>å…³æ³¨ç‚¹åˆ†ç¦»</strong>ã€‚å°†å†…å­˜ç³»ç»Ÿçš„å„ä¸ªæ¨¡å‹æ¨¡å—åŒ–ï¼Œä¾‹å¦‚ï¼Œä¸€è‡´æ€§åè®®è§„èŒƒä¸æ›¿æ¢ç­–ç•¥å’Œç¼“å­˜ç´¢å¼•æ˜ å°„æ˜¯åˆ†å¼€çš„ï¼Œç½‘ç»œæ‹“æ‰‘ç»“æ„ä¸å®ç°ä¹Ÿæ˜¯åˆ†å¼€æŒ‡å®šçš„ã€‚</li>
<li><strong>ä¸°å¯Œçš„å¯é…ç½®æ€§</strong>ã€‚å‡ ä¹æ‰€æœ‰å½±å“å†…å­˜å±‚æ¬¡ç»“æ„çš„åŠŸèƒ½å’Œæ—¶åºéƒ½å¯ä»¥æ§åˆ¶ã€‚</li>
<li><strong>å¿«é€Ÿçš„åŸå‹è®¾è®¡</strong>ã€‚ä½¿ç”¨ä¸€ç§é«˜çº§è§„èŒƒè¯­è¨€SLICCæ¥æŒ‡å®šå„ç§æ§åˆ¶å™¨çš„åŠŸèƒ½ã€‚</li>
</ul>
<p><strong>SLICC + ä¸€è‡´æ€§åè®®</strong></p>
<p>SLICCï¼šSpecification Language for Implementing Cache Coherenceï¼Œæ˜¯ä¸€ç§ç‰¹å®šé¢†åŸŸçš„è¯­è¨€ï¼Œç”¨äºæŒ‡å®šç¼“å­˜ä¸€è‡´æ€§åè®®ã€‚</p>
<p>ç¼“å­˜ä¸€è‡´æ€§åè®®ä»¥çŠ¶æ€æœºçš„æ–¹å¼å·¥ä½œï¼Œè€ŒSLICCç”¨äºæŒ‡å®šçŠ¶æ€æœºçš„è¡Œä¸ºã€‚SLICCæ–‡ä»¶ä»¥â€œ.smâ€ç»“å°¾ï¼Œå®ƒä»¬æ˜¯çŠ¶æ€æœºæ–‡ä»¶ã€‚æ¯ä¸ªæ–‡ä»¶æè¿°çŠ¶æ€ã€æŸäº›äº‹ä»¶ä»å¼€å§‹çŠ¶æ€åˆ°ç»“æŸçŠ¶æ€çš„è½¬æ¢ï¼Œä»¥åŠåœ¨è½¬æ¢è¿‡ç¨‹ä¸­è¦é‡‡å–çš„æ“ä½œã€‚</p>
<p>æ¯ä¸ªä¸€è‡´æ€§åè®®éƒ½ç”±å¤šä¸ªSLICCçŠ¶æ€æœºæ–‡ä»¶ç»„æˆã€‚è¿™äº›æ–‡ä»¶æ˜¯ç”¨SLCCç¼–è¯‘å™¨ç¼–è¯‘çš„ï¼Œè¯¥ç¼–è¯‘å™¨æ˜¯ç”¨Pythonç¼–å†™çš„ï¼Œä¹Ÿæ˜¯gem5æºä»£ç çš„ä¸€éƒ¨åˆ†ã€‚SLICç¼–è¯‘å™¨<u>è·å–çŠ¶æ€æœºæ–‡ä»¶</u>å¹¶<u>è¾“å‡ºä¸€ç»„C++æ–‡ä»¶</u>ï¼Œè¿™äº›æ–‡ä»¶ä¸gem5çš„æ‰€æœ‰å…¶ä»–æ–‡ä»¶ä¸€èµ·ç¼–è¯‘ã€‚è¿™äº›æ–‡ä»¶åŒ…æ‹¬SimObjectå£°æ˜æ–‡ä»¶ä»¥åŠSimObjectså’Œå…¶ä»–C++å¯¹è±¡çš„å®ç°æ–‡ä»¶ã€‚</p>
<h1 id="å®ç°ä¸€è‡´æ€§åè®®çš„æ­¥éª¤"><a href="#å®ç°ä¸€è‡´æ€§åè®®çš„æ­¥éª¤" class="headerlink" title="å®ç°ä¸€è‡´æ€§åè®®çš„æ­¥éª¤"></a>å®ç°ä¸€è‡´æ€§åè®®çš„æ­¥éª¤</h1><p>ä»¥ä¸‹æ˜¯å¯¹å®˜ç½‘æ•™ç¨‹<a target="_blank" rel="noopener" href="https://www.gem5.org/documentation/learning_gem5/part3/MSIintro/">gem5: Introduction to Ruby</a>çš„å†…å®¹æ•´ç†ï¼Œæ•™ç¨‹çš„ç›®æ ‡æ˜¯å®ç°MSIåè®®ï¼Œåè®®çš„å…·ä½“å†…å®¹å¯ä»¥åœ¨ã€ŠA Primer on Memory Consistency and Cache Coherenceã€‹ä¹¦çš„ç¬¬8.2èŠ‚æ‰¾åˆ° (pages 141-149)</p>
<h2 id="1-æ³¨å†ŒçŠ¶æ€æœº"><a href="#1-æ³¨å†ŒçŠ¶æ€æœº" class="headerlink" title="1. æ³¨å†ŒçŠ¶æ€æœº"></a>1. æ³¨å†ŒçŠ¶æ€æœº</h2><p>MSIåè®®æ˜¯é€šè¿‡SLICCè¯­è¨€ç¼–å†™çš„çŠ¶æ€æœºæ–‡ä»¶å®ç°çš„ï¼Œè¿™äº›çŠ¶æ€æœºæ–‡ä»¶æ˜¯ç”¨SLCCç¼–è¯‘å™¨ç¼–è¯‘çš„ï¼Œä¼šé€šè¿‡sconsä¸gem5å…¶ä»–æ–‡ä»¶ä¸€èµ·ç¼–è¯‘ï¼Œå› æ­¤éœ€è¦ä¸ºSConsåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œä»¥ä¾¿çŸ¥é“è¦ç¼–è¯‘ä»€ä¹ˆã€‚è¿™é‡Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<code>Sconsopts</code>æ–‡ä»¶ï¼Œè€Œä¸æ˜¯<code>Sconscript</code>æ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸º<code>Sconsopts</code>ä¼šåœ¨<code>Sconscript</code>ä¹‹å‰æ‰§è¡Œï¼Œè€Œæˆ‘ä»¬ä¹Ÿéœ€è¦åœ¨ç¼–è¯‘gem5ä¹‹å‰ç¼–è¯‘çŠ¶æ€æœºæ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Import(&#x27;*&#x27;)</span><br><span class="line"># æ³¨å†Œåè®®åâ€˜MSIâ€™ï¼ŒSconså°†å‡å®šä¸€ä¸ªåä¸ºMSI.sliccçš„æ–‡ä»¶</span><br><span class="line">main.Append(ALL_PROTOCOLS=[&#x27;MSI&#x27;])</span><br><span class="line"># å‘Šè¯‰SConsåœ¨å½“å‰ç›®å½•ä¸­æŸ¥æ‰¾è¦ä¼ é€’ç»™SLCCç¼–è¯‘å™¨çš„æ–‡ä»¶ã€‚</span><br><span class="line">main.Append(PROTOCOL_DIRS=[Dir(&#x27;.&#x27;)])</span><br></pre></td></tr></table></figure>



<h2 id="2-ç¼–å†™çŠ¶æ€æœºæ–‡ä»¶"><a href="#2-ç¼–å†™çŠ¶æ€æœºæ–‡ä»¶" class="headerlink" title="2.ç¼–å†™çŠ¶æ€æœºæ–‡ä»¶"></a>2.ç¼–å†™çŠ¶æ€æœºæ–‡ä»¶</h2><p>ç¼–å†™çŠ¶æ€æœºæ–‡ä»¶æ˜¯å®ç°ä¸€è‡´æ€§åè®®çš„æœ€ä¸»è¦å·¥ä½œï¼ŒçŠ¶æ€æœºæ–‡ä»¶é€šå¸¸åŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ul>
<li><p>Parameters</p>
<p>These are the parameters for the SimObject that will be generated from the SLICC code.</p>
</li>
<li><p>Declaring required structures and functions</p>
<p>This section declares the states, events, and many other required structures for the state machine.</p>
</li>
<li><p>In port code blocks</p>
<p>Contain code that looks at incoming messages from the (<code>in_port</code>) message buffers and determines what events to trigger.</p>
</li>
<li><p>Actions</p>
<p>These are simple one-effect code blocks (e.g., send a message) that are executed when going through a transition.</p>
</li>
<li><p>Transitions</p>
<p>Specify actions to execute given a starting state and an event and the final state. This is the meat of the state machine definition.</p>
</li>
</ul>
<p>Over the next few sections we will go over how to write each of these components of the protocol.</p>
<h3 id="2-1-çŠ¶æ€æœºå£°æ˜"><a href="#2-1-çŠ¶æ€æœºå£°æ˜" class="headerlink" title="2.1 çŠ¶æ€æœºå£°æ˜"></a>2.1 çŠ¶æ€æœºå£°æ˜</h3><p>åˆ›å»ºä¸€ä¸ªåä¸º<code>MSI-call.sm</code>çš„æ–‡ä»¶ï¼Œå¹¶æŒ‰ä»¥ä¸‹æ ¼å¼å£°æ˜çŠ¶æ€æœº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">machine(MachineType:L1Cache, &quot;MSI cache&quot;)</span><br><span class="line">    : &lt;parameters&gt;</span><br><span class="line">&#123;</span><br><span class="line">    &lt;All state machine code&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>MachineType:L1Cache</code>å°†çŠ¶æ€æœºå‘½åä¸º<code>L1Cache</code>ï¼ŒSLICC å°†ä½¿ç”¨è¯¥åç§°ä¸ºæˆ‘ä»¬ç”Ÿæˆè®¸å¤šä¸åŒçš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œä¸€æ—¦ç¼–è¯‘äº†è¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªæ–°çš„ SimObject: <code>L1Cache_Controller</code> ä½œä¸ºç¼“å­˜æ§åˆ¶å™¨ã€‚è¿™ä¸ªå£°æ˜ä¸­è¿˜åŒ…æ‹¬å¯¹è¿™ä¸ªçŠ¶æ€æœºçš„æè¿°: â€œ MSI cacheâ€ã€‚</p>
<h3 id="2-2-çŠ¶æ€æœºå‚æ•°å£°æ˜"><a href="#2-2-çŠ¶æ€æœºå‚æ•°å£°æ˜" class="headerlink" title="2.2 çŠ¶æ€æœºå‚æ•°å£°æ˜"></a>2.2 çŠ¶æ€æœºå‚æ•°å£°æ˜</h3><p>çŠ¶æ€æœºå‚æ•°çš„å£°æ˜åœ¨å†’å·ï¼ˆï¼šï¼‰ä¹‹å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">machine(MachineType:L1Cache, &quot;MSI cache&quot;)</span><br><span class="line">: Sequencer *sequencer;</span><br><span class="line">  CacheMemory *cacheMemory;</span><br><span class="line">  bool send_evictions;</span><br><span class="line">  # â€œToâ€ buffer</span><br><span class="line">  MessageBuffer * requestToDir, network=&quot;To&quot;, virtual_network=&quot;0&quot;, vnet_type=&quot;request&quot;;</span><br><span class="line">  MessageBuffer * responseToDirOrSibling, network=&quot;To&quot;, virtual_network=&quot;2&quot;, vnet_type=&quot;response&quot;;</span><br><span class="line">  # â€œFromâ€ buffer</span><br><span class="line">  MessageBuffer * forwardFromDir, network=&quot;From&quot;, virtual_network=&quot;1&quot;, vnet_type=&quot;forward&quot;;</span><br><span class="line">  MessageBuffer * responseFromDirOrSibling, network=&quot;From&quot;, virtual_network=&quot;2&quot;, vnet_type=&quot;response&quot;;</span><br><span class="line">  # â€œToâ€ buffer</span><br><span class="line">  MessageBuffer * mandatoryQueue;</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>æ’åºå™¨ï¼ˆSequencerï¼‰</p>
<p>Sequenceræ˜¯ä¸€ä¸ªå¸¦æœ‰ä»ç«¯å£çš„gem5 MemObjectï¼Œå› æ­¤å®ƒå¯ä»¥æ¥å—æ¥è‡ªå…¶ä»–å¯¹è±¡çš„å†…å­˜è¯·æ±‚ã€‚Swquenceræ¥å—æ¥è‡ªCPUï¼ˆæˆ–å…¶ä»–ä¸»ç«¯å£ï¼‰çš„è¯·æ±‚ï¼Œå¹¶å°†gem5æ•°æ®åŒ…è½¬æ¢ä¸ºRubyRequestã€‚æœ€åï¼ŒRubyRequestè¢«æ¨é€åˆ°çŠ¶æ€æœºçš„å¼ºåˆ¶é˜Ÿåˆ—ï¼ˆcommandoryQueueï¼‰ä¸­ã€‚</p>
</li>
<li><p>ç¼“å­˜æ•°æ®ï¼ˆCache Memoryï¼‰</p>
<p>ç”¨äºä¿å­˜ç¼“å­˜æ•°æ®ï¼ˆå³ç¼“å­˜æ¡ç›®ï¼‰çš„å†…å®¹ã€‚</p>
</li>
<li><p>æ¶ˆæ¯ç¼“å†²åŒºï¼ˆMessageBufferï¼‰</p>
<p>æ¶ˆæ¯ç¼“å†²åŒºæ˜¯çŠ¶æ€æœºå’ŒRubyç½‘ç»œä¹‹é—´çš„æ¥å£ã€‚é€šè¿‡æ¶ˆæ¯ç¼“å†²åŒºå‘é€å’Œæ¥æ”¶æ¶ˆæ¯ã€‚å› æ­¤ï¼Œå¯¹äºæˆ‘ä»¬åè®®ä¸­çš„æ¯ä¸ªè™šæ‹Ÿé€šé“ï¼Œæˆ‘ä»¬éƒ½éœ€è¦ä¸€ä¸ªå•ç‹¬çš„æ¶ˆæ¯ç¼“å†²åŒºã€‚</p>
<p>è™šæ‹Ÿç½‘ç»œçš„ä½œç”¨æ˜¯é˜²æ­¢æ­»é”ã€‚MSIåè®®éœ€è¦ä¸‰ä¸ªä¸åŒçš„è™šæ‹Ÿç½‘ç»œã€‚åœ¨è¯¥åè®®ä¸­ï¼Œæœ€é«˜ä¼˜å…ˆçº§æ˜¯å“åº”Responseï¼ˆè™šæ‹Ÿç½‘ç»œ2ï¼‰ï¼Œå…¶æ¬¡æ˜¯è½¬å‘çš„è¯·æ±‚Forwarded Requestsï¼ˆè™šæ‹Ÿç½‘ç»œ1ï¼‰ï¼Œç„¶åè¯·æ±‚Requestså…·æœ‰æœ€ä½ä¼˜å…ˆçº§ï¼ˆè™šæ‹Ÿç½‘ç»œ0ï¼‰ã€‚</p>
<p>ä»£ç ä¸­æœ‰ä¸¤ä¸ªâ€Toâ€ bufferï¼Œä¸¤ä¸ªâ€Fromâ€ bufferå’Œä¸€ä¸ªSpecial bufferã€‚å…¶ä¸­ï¼Œâ€Toâ€ bufferç±»ä¼¼äºgem5ä¸­çš„ä¸»ç«¯å£ï¼Œæ˜¯æ­¤æ§åˆ¶å™¨ç”¨æ¥å‘ç³»ç»Ÿä¸­çš„å…¶ä»–æ§åˆ¶å™¨å‘é€æ¶ˆæ¯çš„æ¶ˆæ¯ç¼“å†²åŒºï¼›â€Fromâ€ bufferç±»ä¼¼äºgem5ä¸­çš„ä»ç«¯å£ï¼Œæ˜¯æ­¤æ§åˆ¶å™¨ç”¨æ¥æ¥æ”¶ç³»ç»Ÿä¸­å…¶ä»–æ§åˆ¶å™¨å‘é€çš„æ¶ˆæ¯çš„æ¶ˆæ¯ç¼“å†²åŒºï¼›å¯¹äºSpecial bufferï¼ŒSequencerä½¿ç”¨æ­¤æ¶ˆæ¯ç¼“å†²åŒºå°†gem5æ•°æ®åŒ…è½¬æ¢ä¸ºRubyè¯·æ±‚ã€‚ä¸å…¶ä»–æ¶ˆæ¯ç¼“å†²åŒºä¸åŒï¼ŒcommandoryQueueä¸è¿æ¥åˆ°Rubyç½‘ç»œï¼Œå¹¶ä¸”ï¼Œæ­¤æ¶ˆæ¯ç¼“å†²åŒºçš„åç§°æ˜¯ç¡¬ç¼–ç çš„ï¼Œå¿…é¡»ä¸ºâ€œcommandoryQueueâ€</p>
<p>ä¸¤ä¸ªâ€Toâ€ bufferä¸€ä¸ªç”¨äºä½ä¼˜å…ˆçº§è¯·æ±‚ï¼Œå¦ä¸€ä¸ªç”¨äºé«˜ä¼˜å…ˆçº§å“åº”ã€‚ä¼˜å…ˆçº§åŸºäºå…¶ä»–æ§åˆ¶å™¨æŸ¥çœ‹æ¶ˆæ¯ç¼“å†²åŒºçš„é¡ºåºã€‚ç±»ä¼¼åœ°ï¼Œä¸¤ä¸ªâ€Fromâ€ bufferä½¿è¯¥ç¼“å­˜å¯ä»¥é€šè¿‡ä¸¤ç§ä¸åŒçš„æ–¹å¼æ¥æ”¶æ¶ˆæ¯ï¼Œè¦ä¹ˆä½œä¸ºæ¥è‡ªç›®å½•çš„è½¬å‘è¯·æ±‚ï¼Œè¦ä¹ˆä½œä¸ºå¯¹è¯¥æ§åˆ¶å™¨å‘å‡ºçš„è¯·æ±‚çš„å“åº”ã€‚å“åº”çš„ä¼˜å…ˆçº§é«˜äºè½¬å‘çš„è¯·æ±‚ã€‚</p>
</li>
</ul>
<p>å¦‚å‰æ‰€è¿°ï¼ŒçŠ¶æ€æœºæ–‡ä»¶åœ¨ç»è¿‡SLICCç¼–è¯‘åä¼šæˆä¸ºSimobjectæ–‡ä»¶ï¼Œä»¥ä¸Šä»£ç ç¼–è¯‘åäº§ç”Ÿçš„æ–‡ä»¶ä¸º<code>L1Cache_Controller.py</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from m5.params import *</span><br><span class="line">from m5.SimObject import SimObject</span><br><span class="line">from Controller import RubyController</span><br><span class="line"></span><br><span class="line">class L1Cache_Controller(RubyController):</span><br><span class="line">    type = &#x27;L1Cache_Controller&#x27;</span><br><span class="line">    cxx_header = &#x27;mem/protocol/L1Cache_Controller.hh&#x27;</span><br><span class="line">    sequencer = Param.RubySequencer(&quot;&quot;)</span><br><span class="line">    cacheMemory = Param.RubyCache(&quot;&quot;)</span><br><span class="line">    send_evictions = Param.Bool(&quot;&quot;)</span><br><span class="line">    requestToDir = Param.MessageBuffer(&quot;&quot;)</span><br><span class="line">    responseToDirOrSibling = Param.MessageBuffer(&quot;&quot;)</span><br><span class="line">    forwardFromDir = Param.MessageBuffer(&quot;&quot;)</span><br><span class="line">    responseFromDirOrSibling = Param.MessageBuffer(&quot;&quot;)</span><br><span class="line">    mandatoryQueue = Param.MessageBuffer(&quot;&quot;)</span><br></pre></td></tr></table></figure>

<p>å¯¹è¿™ä¸ªæ–‡ä»¶ï¼Œ<strong>ä¸èƒ½åšä»»ä½•ä¿®æ”¹ï¼</strong></p>
<h3 id="2-3-çŠ¶æ€å£°æ˜"><a href="#2-3-çŠ¶æ€å£°æ˜" class="headerlink" title="2.3 çŠ¶æ€å£°æ˜"></a>2.3 çŠ¶æ€å£°æ˜</h3><p>é€šè¿‡<code>state_declaration</code>å£°æ˜çŠ¶æ€æœºçš„æ‰€æœ‰ç¨³å®šå’Œç¬æ€ã€‚å¯¹ç¬æ€çš„å‘½åéµå¾ªSorinç­‰äººçš„å‘½åçº¦å®šã€‚ä¾‹å¦‚ï¼Œç¬æ€â€œIM_ADâ€å¯¹åº”äºåœ¨ç­‰å¾…ç¡®è®¤ï¼ˆAï¼‰å’Œæ•°æ®ï¼ˆDï¼‰æ—¶ä»æ— æ•ˆï¼ˆIï¼‰ç§»åŠ¨åˆ°å·²ä¿®æ”¹ï¼ˆMï¼‰ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">state_declaration(State, desc=&quot;Cache states&quot;) &#123;</span><br><span class="line">    I,      AccessPermission:Invalid,</span><br><span class="line">                desc=&quot;Not present/Invalid&quot;;</span><br><span class="line"></span><br><span class="line">    // States moving out of I</span><br><span class="line">    IS_D,   AccessPermission:Invalid,</span><br><span class="line">                desc=&quot;Invalid, moving to S, waiting for data&quot;;</span><br><span class="line">    IM_AD,  AccessPermission:Invalid,</span><br><span class="line">                desc=&quot;Invalid, moving to M, waiting for acks and data&quot;;</span><br><span class="line">    IM_A,   AccessPermission:Busy,</span><br><span class="line">                desc=&quot;Invalid, moving to M, waiting for acks&quot;;</span><br><span class="line"></span><br><span class="line">    S,      AccessPermission:Read_Only,</span><br><span class="line">                desc=&quot;Shared. Read-only, other caches may have the block&quot;;</span><br><span class="line"></span><br><span class="line">    // States moving out of S</span><br><span class="line">    SM_AD,  AccessPermission:Read_Only,</span><br><span class="line">                desc=&quot;Shared, moving to M, waiting for acks and &#x27;data&#x27;&quot;;</span><br><span class="line">    SM_A,   AccessPermission:Read_Only,</span><br><span class="line">                desc=&quot;Shared, moving to M, waiting for acks&quot;;</span><br><span class="line"></span><br><span class="line">    M,      AccessPermission:Read_Write,</span><br><span class="line">                desc=&quot;Modified. Read &amp; write permissions. Owner of block&quot;;</span><br><span class="line"></span><br><span class="line">    // States moving to Invalid</span><br><span class="line">    MI_A,   AccessPermission:Busy,</span><br><span class="line">                desc=&quot;Was modified, moving to I, waiting for put ack&quot;;</span><br><span class="line">    SI_A,   AccessPermission:Busy,</span><br><span class="line">                desc=&quot;Was shared, moving to I, waiting for put ack&quot;;</span><br><span class="line">    II_A,   AccessPermission:Invalid,</span><br><span class="line">                desc=&quot;Sent valid data before receiving put ack. &quot;Waiting for put ack.&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¯ä¸ªçŠ¶æ€éƒ½æœ‰ä¸€ä¸ªç›¸å…³çš„è®¿é—®æƒé™<code>AccessPermission</code>ï¼ŒåŒ…æ‹¬æ— æ•ˆï¼ˆ<strong>Invalid</strong>ï¼‰ã€ä¸å­˜åœ¨ï¼ˆ<strong>NotPresent</strong>ï¼‰ã€å¿™ï¼ˆ<strong>Busy</strong>ï¼‰ã€åªè¯»ï¼ˆ<strong>Read_Only</strong>ï¼‰ã€è¯»å†™ï¼ˆ<strong>Read_Write</strong>ï¼‰ï¼Œè®¿é—®æƒé™ç”¨äºå¯¹ç¼“å­˜è¿›è¡ŒåŠŸèƒ½è®¿é—®<em>functional accesses</em>ã€‚å¯¹äºåŠŸèƒ½è®¿é—®ï¼Œå°†æ£€æŸ¥æ‰€æœ‰ç¼“å­˜ï¼Œçœ‹å®ƒä»¬æ˜¯å¦æœ‰å…·æœ‰åŒ¹é…åœ°å€çš„ç›¸åº”å—ã€‚</p>
<h3 id="2-4-äº‹ä»¶å£°æ˜"><a href="#2-4-äº‹ä»¶å£°æ˜" class="headerlink" title="2.4 äº‹ä»¶å£°æ˜"></a>2.4 äº‹ä»¶å£°æ˜</h3><p>å£°æ˜ç”±è¯¥ç¼“å­˜æ§åˆ¶å™¨çš„ä¼ å…¥æ¶ˆæ¯è§¦å‘çš„æ‰€æœ‰äº‹ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">enumeration(Event, desc=&quot;Cache events&quot;) &#123;</span><br><span class="line">    // From the processor/sequencer/mandatory queue</span><br><span class="line">    Load,           desc=&quot;Load from processor&quot;;</span><br><span class="line">    Store,          desc=&quot;Store from processor&quot;;</span><br><span class="line"></span><br><span class="line">    // Internal event (only triggered from processor requests)</span><br><span class="line">    Replacement,    desc=&quot;Triggered when block is chosen as victim&quot;;</span><br><span class="line"></span><br><span class="line">    // Forwarded request from other cache via dir on the forward network</span><br><span class="line">    FwdGetS,        desc=&quot;Directory sent us a request to satisfy GetS. We must have the block in M to respond to this.&quot;;</span><br><span class="line">    FwdGetM,        desc=&quot;Directory sent us a request to satisfy GetM. We must have the block in M to respond to this.&quot;;</span><br><span class="line">    Inv,            desc=&quot;Invalidate from the directory.&quot;;</span><br><span class="line">    PutAck,         desc=&quot;Response from directory after we issue a put. This must be on the fwd network to avoid deadlock.&quot;;</span><br><span class="line"></span><br><span class="line">    // Responses from directory</span><br><span class="line">    DataDirNoAcks,  desc=&quot;Data from directory (acks = 0)&quot;;</span><br><span class="line">    DataDirAcks,    desc=&quot;Data from directory (acks &gt; 0)&quot;;</span><br><span class="line"></span><br><span class="line">    // Responses from other caches</span><br><span class="line">    DataOwner,      desc=&quot;Data from owner&quot;;</span><br><span class="line">    InvAck,         desc=&quot;Invalidation ack from other cache after Inv&quot;;</span><br><span class="line"></span><br><span class="line">    // Special event to simplify implementation</span><br><span class="line">    LastInvAck,     desc=&quot;Triggered after the last ack is received&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>çŠ¶æ€å’Œäº‹ä»¶å¯ä»¥å‚è€ƒè¡¨8.3çš„ç¼“å­˜æ§åˆ¶å™¨è½¬æ¢è¡¨</p>
<p><img src="/Gem5%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89/image-20231204190803198.png" alt="image-20231204190803198"></p>
<h3 id="2-5-ç”¨æˆ·å®šä¹‰ç»“æ„ä½“"><a href="#2-5-ç”¨æˆ·å®šä¹‰ç»“æ„ä½“" class="headerlink" title="2.5 ç”¨æˆ·å®šä¹‰ç»“æ„ä½“"></a>2.5 ç”¨æˆ·å®šä¹‰ç»“æ„ä½“</h3><p>ä¸‹é¢å®šä¹‰çš„æ˜¯åœ¨è¿™ä¸ªæ§åˆ¶å™¨çš„å…¶ä»–åœ°æ–¹ç”¨åˆ°çš„ç»“æ„ä½“</p>
<h4 id="Entry"><a href="#Entry" class="headerlink" title="Entry"></a>Entry</h4><p>è¿™æ˜¯å­˜å‚¨åœ¨CacheMemoryä¸­çš„ç»“æ„ã€‚å®ƒåªéœ€è¦åŒ…å«æ•°æ®å’ŒçŠ¶æ€</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">structure(Entry, desc=&quot;Cache entry&quot;, interface=&quot;AbstractCacheEntry&quot;) &#123;</span><br><span class="line">    State CacheState,        desc=&quot;cache state&quot;;</span><br><span class="line">    DataBlock DataBlk,       desc=&quot;Data in the block&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="TBE"><a href="#TBE" class="headerlink" title="TBE"></a>TBE</h4><p>TBEæ˜¯â€œäº‹åŠ¡ç¼“å†²åŒºæ¡ç›®â€ã€‚è¿™å­˜å‚¨äº†ç¬æ€æœŸé—´æ‰€éœ€çš„ä¿¡æ¯ã€‚è¿™å°±åƒMSHRã€‚å®ƒåœ¨è¯¥åè®®ä¸­èµ·MSHRçš„ä½œç”¨ï¼Œä½†è¯¥æ¡ç›®ä¹Ÿè¢«åˆ†é…ç”¨äºå…¶ä»–ç”¨é€”ã€‚åœ¨è¯¥åè®®ä¸­ï¼Œå®ƒå°†å­˜å‚¨çŠ¶æ€ï¼ˆé€šå¸¸éœ€è¦ï¼‰ã€æ•°æ®ï¼ˆé€šå¸¸ä¹Ÿéœ€è¦ï¼‰ä»¥åŠè¯¥å—å½“å‰æ­£åœ¨ç­‰å¾…çš„ackæ•°ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">structure(TBE, desc=&quot;Entry for transient requests&quot;) &#123;</span><br><span class="line">    State TBEState,         desc=&quot;State of block&quot;;</span><br><span class="line">    DataBlock DataBlk,      desc=&quot;Data for the block. Needed for MI_A&quot;;</span><br><span class="line">    int AcksOutstanding, default=0, desc=&quot;Number of acks left to receive.&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="TBETable"><a href="#TBETable" class="headerlink" title="TBETable"></a>TBETable</h4><p>è¿˜éœ€è¦ä¸€ä¸ªå­˜æ”¾æ‰€æœ‰TBEçš„åœ°æ–¹ã€‚å…¶ä¸­<code>external=&quot;yes&quot;</code>è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå¤–éƒ¨å®šä¹‰çš„ç±»ï¼›å®ƒæ˜¯åœ¨SLICCä¹‹å¤–çš„C++ä¸­å®šä¹‰çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å£°æ˜æˆ‘ä»¬å°†è¦ä½¿ç”¨å®ƒï¼Œå¹¶å£°æ˜æˆ‘ä»¬å°†å¯¹å…¶è°ƒç”¨çš„ä»»ä½•å‡½æ•°ã€‚æ‚¨å¯ä»¥åœ¨src&#x2F;mem&#x2F;ruby&#x2F;structures&#x2F;TBETable.hhä¸­æ‰¾åˆ°TBETableçš„ä»£ç ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">structure(TBETable, external=&quot;yes&quot;) &#123;</span><br><span class="line">  TBE lookup(Addr);</span><br><span class="line">  void allocate(Addr);</span><br><span class="line">  void deallocate(Addr);</span><br><span class="line">  bool isPresent(Addr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å¤–éƒ¨å‡½æ•°å£°æ˜"><a href="#å¤–éƒ¨å‡½æ•°å£°æ˜" class="headerlink" title="å¤–éƒ¨å‡½æ•°å£°æ˜"></a>å¤–éƒ¨å‡½æ•°å£°æ˜</h4><p>å¦‚æœæˆ‘ä»¬è¦åœ¨æ–‡ä»¶çš„å…¶ä½™éƒ¨åˆ†ä¸­ä½¿ç”¨AbstractControllerä¸­çš„ä»»ä½•å‡½æ•°ï¼Œéƒ½éœ€è¦å£°æ˜å®ƒä»¬ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Tick clockEdge();</span><br><span class="line">void set_cache_entry(AbstractCacheEntry a);</span><br><span class="line">void unset_cache_entry();</span><br><span class="line">void set_tbe(TBE b);</span><br><span class="line">void unset_tbe();</span><br></pre></td></tr></table></figure>

<h4 id="æ ·æ¿ä»£ç "><a href="#æ ·æ¿ä»£ç " class="headerlink" title="æ ·æ¿ä»£ç "></a>æ ·æ¿ä»£ç </h4><p>ä¸‹é¢è¿™ä¸€ç»„æ ·æ¿å·¥å…·ä»£ç å¾ˆå°‘åœ¨ä¸åŒçš„åè®®ä¹‹é—´å‘ç”Ÿå˜åŒ–ã€‚åœ¨AbstractControllerä¸­ï¼Œæˆ‘ä»¬å¿…é¡»å®ç°ä¸€ç»„çº¯è™šæ‹Ÿçš„å‡½æ•°ã€‚</p>
<ul>
<li>getState</li>
</ul>
<p>Given a TBE, cache entry, and address return the state of the block. This is called on the block to decide which transition to execute when an event is triggered. Usually, you return the state in the TBE or cache entry, whichever is valid.</p>
<p>ç»™å®šIBEï¼Œentryå’Œåœ°å€ï¼Œè¿”å›åœ°å€æ‰€åœ¨ç¼“å­˜å—çš„çŠ¶æ€</p>
<ul>
<li>setState</li>
</ul>
<p>Given a TBE, cache entry, and address make sure the state is set correctly on the block. This is called at the end of the transition to set the final state on the block.</p>
<ul>
<li>getAccessPermission</li>
</ul>
<p>Get the access permission of a block. This is used during functional access to decide whether or not to functionally access the block. It is similar to <code>getState</code>, get the information from the TBE if valid, cache entry, if valid, or the block is not present.</p>
<ul>
<li>setAccessPermission</li>
</ul>
<p>Like <code>getAccessPermission</code>, but sets the permission.</p>
<ul>
<li>functionalRead</li>
</ul>
<p>Functionally read the data. It is possible the TBE has more up-to-date information, so check that first. Note: testAndRead&#x2F;Write defined in src&#x2F;mem&#x2F;ruby&#x2F;slicc_interface&#x2F;Util.hh</p>
<ul>
<li>functionalWrite</li>
</ul>
<p>Functionally write the data. Similarly, you may need to update the data in both the TBE and the cache entry.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">State getState(TBE tbe, Entry cache_entry, Addr addr) &#123;</span><br><span class="line">    // The TBE state will override the state in cache memory, if valid</span><br><span class="line">    if (is_valid(tbe)) &#123; return tbe.TBEState; &#125;</span><br><span class="line">    // Next, if the cache entry is valid, it holds the state</span><br><span class="line">    else if (is_valid(cache_entry)) &#123; return cache_entry.CacheState; &#125;</span><br><span class="line">    // If the block isn&#x27;t present, then it&#x27;s state must be I.</span><br><span class="line">    else &#123; return State:I; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void setState(TBE tbe, Entry cache_entry, Addr addr, State state) &#123;</span><br><span class="line">  if (is_valid(tbe)) &#123; tbe.TBEState := state; &#125;</span><br><span class="line">  if (is_valid(cache_entry)) &#123; cache_entry.CacheState := state; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">AccessPermission getAccessPermission(Addr addr) &#123;</span><br><span class="line">    TBE tbe := TBEs[addr];</span><br><span class="line">    if(is_valid(tbe)) &#123;</span><br><span class="line">        return L1Cache_State_to_permission(tbe.TBEState);</span><br><span class="line">    &#125;</span><br><span class="line">    Entry cache_entry := getCacheEntry(addr);</span><br><span class="line">    if(is_valid(cache_entry)) &#123;</span><br><span class="line">        return L1Cache_State_to_permission(cache_entry.CacheState);</span><br><span class="line">    &#125;</span><br><span class="line">    return AccessPermission:NotPresent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void setAccessPermission(Entry cache_entry, Addr addr, State state) &#123;</span><br><span class="line">    if (is_valid(cache_entry)) &#123;</span><br><span class="line">        cache_entry.changePermission(L1Cache_State_to_permission(state));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void functionalRead(Addr addr, Packet *pkt) &#123;</span><br><span class="line">    TBE tbe := TBEs[addr];</span><br><span class="line">    if(is_valid(tbe)) &#123;</span><br><span class="line">        testAndRead(addr, tbe.DataBlk, pkt);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        testAndRead(addr, getCacheEntry(addr).DataBlk, pkt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int functionalWrite(Addr addr, Packet *pkt) &#123;</span><br><span class="line">    int num_functional_writes := 0;</span><br><span class="line">    TBE tbe := TBEs[addr];</span><br><span class="line">    if(is_valid(tbe)) &#123;</span><br><span class="line">        num_functional_writes := num_functional_writes +</span><br><span class="line">            testAndWrite(addr, tbe.DataBlk, pkt);</span><br><span class="line">        return num_functional_writes;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>





<p>ä»¥ä¸‹æ˜¯å¯¹è¿™äº›çŠ¶æ€å’Œè½¬æ¢çš„é«˜å±‚æ¬¡æè¿°ï¼š</p>
<p><img src="/Gem5%E6%A8%A1%E6%8B%9F%E5%99%A8%E5%AD%A6%E4%B9%A0%EF%BC%88%E5%85%AB%EF%BC%89/v2-c033b43df7af58f9468432e564c4266f_720w.png" alt="img"></p>
<h3 id="2-6-è¾“å…¥è¾“å‡ºç«¯å£"><a href="#2-6-è¾“å…¥è¾“å‡ºç«¯å£" class="headerlink" title="2.6 è¾“å…¥è¾“å‡ºç«¯å£"></a>2.6 è¾“å…¥è¾“å‡ºç«¯å£</h3><p>å‚è€ƒé“¾æ¥ğŸ”—</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/539342291">gem5æ¨¡æ‹Ÿå™¨å…¥é—¨ï¼ˆå››ï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34898487/article/details/134252221">EM5å®˜æ–¹æ•™ç¨‹å…¨æµç¨‹ï¼š part 3 RUBY-CSDNåšå®¢</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Ruby/" rel="tag"># Ruby</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/11/25/Cache%E4%B8%80%E8%87%B4%E6%80%A7%E5%8D%8F%E8%AE%AE/" rel="prev" title="">
                  <i class="fa fa-angle-left"></i> 
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/11/29/%E4%BA%92%E8%81%94%E7%BD%91%E7%BB%9C/" rel="next" title="äº’è”ç½‘ç»œ">
                  äº’è”ç½‘ç»œ <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Mr .L</span>
  </div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
